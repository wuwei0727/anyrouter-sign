name: AnyRouter Daily Sign

on:
  workflow_dispatch:
  schedule:
    # 北京时间 周一至周五 10:00 (UTC 02:00)
    - cron: '0 2 * * 1-5'
    # 北京时间 周六、周日 19:00 (UTC 11:00)
    - cron: '0 11 * * 6,0'

jobs:
  sign-in:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install requests

      - name: Run Sign Script
        env:
          NEW_API_USER: ${{ secrets.NEW_API_USER }}
          COOKIE: ${{ secrets.COOKIE }}
          # 新增 WxPusher 环境变量
          WXPUSHER_APP_TOKEN: ${{ secrets.WXPUSHER_APP_TOKEN }}
          WXPUSHER_UID: ${{ secrets.WXPUSHER_UID }}
        run: python anyrouter-sign.py
